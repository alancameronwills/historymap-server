// Azure Storage JavaScript Client Library 0.2.8-preview.14 
// Copyright (c) Microsoft and contributors. All rights reserved. 
require=function e(t,s,r){function u(o,i){if(!s[o]){if(!t[o]){var a="function"==typeof require&&require;if(!i&&a)return a(o,!0);if(n)return n(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=s[o]={exports:{}};t[o][0].call(c.exports,function(e){var s=t[o][1][e];return u(s||e)},c,c.exports,e,t,s,r)}return s[o].exports}for(var n="function"==typeof require&&require,o=0;o<r.length;o++)u(r[o]);return u}({3:[function(e,t,s){var r=window.AzureStorage||{};r.generateDevelopmentStorageCredentials=function(e){var t="UseDevelopmentStorage=true;";return e&&(t+="DevelopmentStorageProxyUri="+e),t};var u=e("../lib/services/queue/queueservice");r.QueueService=u,r.QueueUtilities=e("../lib/services/queue/queueutilities"),r.QueueMessageEncoder=e("../lib/services/queue/queuemessageencoder"),r.createQueueService=function(e,t,s){return new u(e,t,s)},r.createQueueServiceWithSas=function(e,t){return new u(null,null,e,t)};var n=e("../lib/common/common.browser"),o=n.StorageServiceClient,i=n.SharedKey;r.generateAccountSharedAccessSignature=function(e,t,s){var r=o.getStorageSettings(e,t);return new i(r._name,r._key).generateAccountSignedQueryString(s)},r.Constants=n.Constants,r.StorageUtilities=n.StorageUtilities,r.AccessCondition=n.AccessCondition,r.SR=n.SR,r.StorageServiceClient=o,r.Logger=n.Logger,r.WebResource=n.WebResource,r.Validate=n.validate,r.date=n.date,r.LinearRetryPolicyFilter=n.LinearRetryPolicyFilter,r.ExponentialRetryPolicyFilter=n.ExponentialRetryPolicyFilter,r.RetryPolicyFilter=n.RetryPolicyFilter,window.AzureStorage=r},{"../lib/common/common.browser":5,"../lib/services/queue/queuemessageencoder":59,"../lib/services/queue/queueservice":60,"../lib/services/queue/queueutilities":61}],61:[function(e,t,s){t.exports;t.exports={SharedAccessPermissions:{READ:"r",ADD:"a",UPDATE:"u",PROCESS:"p"}}},{}],60:[function(e,t,s){(function(s){var r=e("util"),u=e("underscore"),n=e("extend"),o=e("./../../common/common.core"),i=o.util,a=o.SR,l=o.validate,c=o.StorageServiceClient,p=o.WebResource,g=o.Constants,d=g.QueryStringConstants,f=g.HeaderConstants,m=g.RequestLocationMode,v=e("./models/queueresult"),E=o.AclResult,q=e("./models/queuemessageresult"),R=e("./queuemessageencoder"),y=o.ServiceStatsParser;function h(e,t,s,r,u){var n=c.getStorageSettings(e,t,s,r,u);if(h.super_.call(this,n._name,n._key,n._queueEndpoint,n._usePathStyleUri,n._sasToken),this.anonymous)throw new Error(a.ANONYMOUS_ACCESS_BLOBSERVICE_ONLY);this.messageEncoder=new R.TextXmlQueueMessageEncoder}r.inherits(h,c),h.prototype.getServiceStats=function(e,t){var s;i.normalizeArgs(e,t,function(e,r){s=e,t=r}),l.validateArgs("getServiceStats",function(e){e.callback(t)});var r=n(!0,{},s),u=p.get().withQueryOption(d.COMP,"stats").withQueryOption(d.RESTYPE,"service");r.requestLocationMode=m.PRIMARY_OR_SECONDARY;this.performRequest(u,null,r,function(e,s){e.serviceStatsResult=null,e.error||(e.serviceStatsResult=y.parse(e.response.body.StorageServiceStats));s(e,function(e){t(e.error,e.serviceStatsResult,e.response)})})},h.prototype.getServiceProperties=function(e,t){return this.getAccountServiceProperties(e,t)},h.prototype.setServiceProperties=function(e,t,s){return this.setAccountServiceProperties(e,t,s)},h.prototype.listQueuesSegmented=function(e,t,s){this.listQueuesSegmentedWithPrefix(null,e,t,s)},h.prototype.listQueuesSegmentedWithPrefix=function(e,t,s,r){var o;i.normalizeArgs(s,r,function(e,t){o=e,r=t}),l.validateArgs("listQueuesSegmentedWithPrefix",function(e){e.callback(r)});var a=n(!0,{},o),c=p.get();c.withQueryOption(d.COMP,"list").withQueryOption(d.MAX_RESULTS,a.maxResults).withQueryOption(d.INCLUDE,a.include).withQueryOption(d.PREFIX,e),i.objectIsNull(t)||c.withQueryOption(d.MARKER,t.nextMarker),a.requestLocationMode=i.getNextListingLocationMode(t);this.performRequest(c,null,a,function(e,t){if(e.listQueuesResult=null,!e.error){e.listQueuesResult={entries:null,continuationToken:null},e.listQueuesResult.entries=[];var s=[];e.response.body.EnumerationResults.Queues&&e.response.body.EnumerationResults.Queues.Queue&&(s=e.response.body.EnumerationResults.Queues.Queue,u.isArray(s)||(s=[s]),s.forEach(function(t){var s=v.parse(t);e.listQueuesResult.entries.push(s)}),e.response.body.EnumerationResults.NextMarker&&(e.listQueuesResult.continuationToken={nextMarker:null,targetLocation:null},e.listQueuesResult.continuationToken.nextMarker=e.response.body.EnumerationResults.NextMarker,e.listQueuesResult.continuationToken.targetLocation=e.targetLocation))}t(e,function(e){r(e.error,e.listQueuesResult,e.response)})})},h.prototype.doesQueueExist=function(e,t,s){this._doesQueueExist(e,!1,t,s)},h.prototype.createQueue=function(e,t,s){var r;i.normalizeArgs(t,s,function(e,t){r=e,s=t}),l.validateArgs("createQueue",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=n(!0,{},r),o=p.put(e);u&&o.addOptionalMetadataHeaders(u.metadata);this.performRequest(o,null,u,function(t,r){t.queueResult=null,t.error||(t.queueResult=new v(e),u&&u.metadata&&(t.queueResult.metadata=u.metadata));r(t,function(e){s(e.error,e.queueResult,e.response)})})},h.prototype.createQueueIfNotExists=function(e,t,s){var r;i.normalizeArgs(t,s,function(e,t){r=e,s=t}),l.validateArgs("createQueueIfNotExists",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=n(!0,{},r),o=this;o._doesQueueExist(e,!0,u,function(t,r,n){var i=r.exists;r.created=!1,delete r.exists,t?s(t,r,n):i?(n.isSuccessful=!0,s(t,r,n)):o.createQueue(e,u,function(e,t,r){e?e&&e.statusCode===g.HttpConstants.HttpResponseCodes.Conflict&&e.code===g.QueueErrorCodeStrings.QUEUE_ALREADY_EXISTS&&(e=null,t.created=!1,r.isSuccessful=!0):t.created=!0,s(e,t,r)})})},h.prototype.deleteQueue=function(e,t,s){var r;i.normalizeArgs(t,s,function(e,t){r=e,s=t}),l.validateArgs("deleteQueue",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=n(!0,{},r),o=p.del(e);this.performRequest(o,null,u,function(e,t){t(e,function(e){s(e.error,e.response)})})},h.prototype.deleteQueueIfExists=function(e,t,s){var r;i.normalizeArgs(t,s,function(e,t){r=e,s=t}),l.validateArgs("deleteQueueIfExists",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=n(!0,{},r),o=this;o._doesQueueExist(e,!0,u,function(t,r,n){t?s(t,r.exists,n):r.exists?o.deleteQueue(e,u,function(e,t){var r;e?e&&e.statusCode===g.HttpConstants.HttpResponseCodes.NotFound&&e.code===g.QueueErrorCodeStrings.QUEUE_NOT_FOUND&&(r=!1,e=null,t.isSuccessful=!0):r=!0,s(e,r,t)}):(n.isSuccessful=!0,s(t,!1,n))})},h.prototype.getQueueMetadata=function(e,t,s){var r;i.normalizeArgs(t,s,function(e,t){r=e,s=t}),l.validateArgs("getQueueMetadata",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=n(!0,{},r),o=p.get(e).withQueryOption(d.COMP,"metadata");u.requestLocationMode=g.RequestLocationMode.PRIMARY_OR_SECONDARY;var a=this;this.performRequest(o,null,u,function(t,r){t.queueResult=null,t.error||(t.queueResult=new v(e),t.queueResult.metadata=a.parseMetadataHeaders(t.response.headers),t.queueResult.getPropertiesFromHeaders(t.response.headers));r(t,function(e){s(e.error,e.queueResult,e.response)})})},h.prototype.setQueueMetadata=function(e,t,s,r){var u;i.normalizeArgs(s,r,function(e,t){u=e,r=t}),l.validateArgs("setQueueMetadata",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(r)});var o=n(!0,{},u),a=p.put(e).withQueryOption(d.COMP,"metadata").addOptionalMetadataHeaders(t);this.performRequest(a,null,o,function(s,u){s.queueResult=null,s.error||(s.queueResult=new v(e,t),s.queueResult.getPropertiesFromHeaders(s.response.headers));u(s,function(e){r(e.error,e.queueResult,e.response)})})},h.prototype.createMessage=function(e,t,r,o){var a;i.normalizeArgs(r,o,function(e,t){a=e,o=t}),l.validateArgs("createMessage",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(o)});var c=q.serialize(t,this.messageEncoder),g=n(!0,{},a),m=p.post(e+"/messages").withHeader(f.CONTENT_TYPE,'application/atom+xml;charset="utf-8"').withHeader(f.CONTENT_LENGTH,s.byteLength(c,"utf8")).withQueryOption(d.MESSAGE_TTL,g.messageTimeToLive).withQueryOption(d.VISIBILITY_TIMEOUT,g.visibilityTimeout).withBody(c),v=this.messageEncoder;this.performRequest(m,m.body,g,function(e,t){if(e.queueMessageResults=[],e.response&&e.response.body&&e.response.body.QueueMessagesList&&e.response.body.QueueMessagesList.QueueMessage){var s=e.response.body.QueueMessagesList.QueueMessage;u.isArray(s)||(s=[s]),s.forEach(function(t){var s=q.parse(t,v);e.queueMessageResults.push(s)})}t(e,function(t){o(t.error,e.queueMessageResults[0],t.response)})})},h.prototype.getMessages=function(e,t,s){var r;i.normalizeArgs(t,s,function(e,t){r=e,s=t}),l.validateArgs("getMessages",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=n(!0,{},r);delete u.peekOnly,this._getOrPeekMessages(e,u,s)},h.prototype.getMessage=function(e,t,s){var r;i.normalizeArgs(t,s,function(e,t){r=e,s=t}),l.validateArgs("getMessage",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=n(!0,{},r);u.numOfMessages=1;this.getMessages(e,u,function(e,t,r){var u;t&&t.length>0&&(u=t[0]),s(e,u,r)})},h.prototype.peekMessages=function(e,t,s){var r;i.normalizeArgs(t,s,function(e,t){r=e,s=t}),l.validateArgs("peekMessages",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=n(!0,{},r);u.peekOnly=!0,delete u.visibilityTimeout,this._getOrPeekMessages(e,u,s)},h.prototype.peekMessage=function(e,t,s){var r;i.normalizeArgs(t,s,function(e,t){r=e,s=t}),l.validateArgs("peekMessage",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=n(!0,{},r);u.numOfMessages=1;this.peekMessages(e,u,function(e,t,r){var u;t&&t.length>0&&(u=t[0]),s(e,u,r)})},h.prototype.deleteMessage=function(e,t,s,r,u){var o;if(i.normalizeArgs(r,u,function(e,t){o=e,u=t}),l.validateArgs("deleteMessage",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(u)}),i.objectIsNull(s))throw new Error(a.INVALID_POP_RECEIPT);if(i.objectIsNull(t))throw new Error(a.INVALID_MESSAGE_ID);var c=n(!0,{},o),g=p.del(e+"/messages/"+t).withQueryOption(d.POP_RECEIPT,s,null,!0);this.performRequest(g,null,c,function(e,t){t(e,function(e){u(e.error,e.response)})})},h.prototype.clearMessages=function(e,t,s){var r;i.normalizeArgs(t,s,function(e,t){r=e,s=t}),l.validateArgs("clearMessages",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=n(!0,{},r),o=p.del(e+"/messages");this.performRequest(o,null,u,function(e,t){t(e,function(e){s(e.error,e.response)})})},h.prototype.updateMessage=function(e,t,r,u,o,c){var g;if(i.normalizeArgs(o,c,function(e,t){g=e,c=t}),l.validateArgs("updateMessage",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(c)}),i.objectIsNull(r))throw new Error(a.INVALID_POP_RECEIPT);if(i.objectIsNull(t))throw new Error(a.INVALID_MESSAGE_ID);var m=n(!0,{},g),v=null;m.messageText&&(v=q.serialize(m.messageText,this.messageEncoder));var E=v?s.byteLength(v,"utf8"):0,R=p.put(e+"/messages/"+t).withHeader(f.CONTENT_TYPE,'application/atom+xml;charset="utf-8"').withHeader(f.CONTENT_LENGTH,E).withQueryOption(d.POP_RECEIPT,r,null,!0).withQueryOption(d.VISIBILITY_TIMEOUT,u).withBody(v);this.performRequest(R,R.body,m,function(s,r){s.queueMessageResult=null,s.error||(s.queueMessageResult=new q(e,t),s.queueMessageResult.getPropertiesFromHeaders(s.response.headers));r(s,function(e){c(e.error,e.queueMessageResult,e.response)})})},h.prototype.getQueueAcl=function(e,t,s){var r;i.normalizeArgs(t,s,function(e,t){r=e,s=t}),l.validateArgs("getQueueAcl",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var u=n(!0,{},r),o=p.get(e).withQueryOption(d.COMP,"acl");u.requestLocationMode=g.RequestLocationMode.PRIMARY_OR_SECONDARY;this.performRequest(o,null,u,function(t,r){t.queueResult=null,t.error||(t.queueResult=new v(e),t.queueResult.getPropertiesFromHeaders(t.response.headers),t.queueResult.signedIdentifiers=E.parse(t.response.body));r(t,function(e){s(e.error,e.queueResult,e.response)})})},h.prototype.setQueueAcl=function(e,t,r,o){var c;i.normalizeArgs(r,o,function(e,t){c=e,o=t}),l.validateArgs("setQueueAcl",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(o)});var g=n(!0,{},c),m=null;if(t){if(u.isArray(t))throw new TypeError(a.INVALID_SIGNED_IDENTIFIERS);m=E.serialize(t)}var q=p.put(e).withQueryOption(d.COMP,"acl").withHeader(f.CONTENT_LENGTH,i.objectIsNull(m)?0:s.byteLength(m)).withBody(m);this.performRequest(q,q.body,g,function(s,r){s.containerResult=null,s.error||(s.queueResult=new v(e),s.queueResult.getPropertiesFromHeaders(s.response.headers),t&&(s.queueResult.signedIdentifiers=t));r(s,function(e){o(e.error,e.queueResult,e.response)})})},h.prototype.generateSharedAccessSignature=function(e,t){if(!this.storageCredentials||!this.storageCredentials.generateSignedQueryString)throw new Error(a.CANNOT_CREATE_SAS_WITHOUT_ACCOUNT_KEY);return l.validateArgs("generateSharedAccessSignature",function(s){s.string(e,"queue"),s.queueNameIsValid(e),s.object(t,"sharedAccessPolicy")}),this.storageCredentials.generateSignedQueryString(g.ServiceType.Queue,e,t,null)},h.prototype._doesQueueExist=function(e,t,s,r){var u;i.normalizeArgs(s,r,function(e,t){u=e,r=t}),l.validateArgs("doesQueueExist",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(r)});var o=n(!0,{},u),a=p.head(e).withQueryOption(d.COMP,"metadata");!1===t&&(o.requestLocationMode=m.PRIMARY_OR_SECONDARY);this.performRequest(a,null,o,function(t,s){t.queueResult=new v(e),t.queueResult.exists=!1,t.error?t.error&&t.error.statusCode===g.HttpConstants.HttpResponseCodes.NotFound&&(t.error=null,t.queueResult.exists=!1,t.response.isSuccessful=!0):(t.queueResult.exists=!0,t.queueResult.getPropertiesFromHeaders(t.response.headers));s(t,function(e){r(e.error,e.queueResult,e.response)})})},h.prototype._getOrPeekMessages=function(e,t,s){var r;i.normalizeArgs(t,s,function(e,t){r=e,s=t}),l.validateArgs("_getOrPeekMessages",function(t){t.string(e,"queue"),t.queueNameIsValid(e),t.callback(s)});var o=n(!0,{},r);o.numOfMessages||(o.numOfMessages=1);var a=p.get(e+"/messages").withQueryOption(d.NUM_OF_MESSAGES,o.numOfMessages).withQueryOption(d.VISIBILITY_TIMEOUT,o.visibilityTimeout).withQueryOption(d.PEEK_ONLY,o.peekOnly);o.peekOnly&&(o.requestLocationMode=m.PRIMARY_OR_SECONDARY);var c=this.messageEncoder;this.performRequest(a,null,o,function(e,t){if(e.queueMessageResults=null,!e.error&&(e.queueMessageResults=[],e.response.body.QueueMessagesList&&e.response.body.QueueMessagesList.QueueMessage)){var r=e.response.body.QueueMessagesList.QueueMessage;u.isArray(r)||(r=[r]),r.forEach(function(t){var s=q.parse(t,c);e.queueMessageResults.push(s)})}t(e,function(e){s(e.error,e.queueMessageResults,e.response)})})},h.prototype.getUrl=function(e,t,s){return l.validateArgs("getUrl",function(t){t.string(e,"queue"),t.queueNameIsValid(e)}),this._getUrl(e,t,s)},t.exports=h}).call(this,e("buffer").Buffer)},{"./../../common/common.core":6,"./models/queuemessageresult":57,"./models/queueresult":58,"./queuemessageencoder":59,buffer:"buffer",extend:158,underscore:249,util:"util"}],58:[function(e,t,s){var r=e("./../../../common/common.core").Constants.HeaderConstants;function u(e,t){e&&(this.name=e),t&&(this.metadata=t)}u.parse=function(e){var t=new u;for(var s in e)e.hasOwnProperty(s)&&(t[s.toLowerCase()]=e[s]);return t},u.prototype.getPropertiesFromHeaders=function(e){var t,s,u,n=this;t="approximateMessageCount",s=r.APPROXIMATE_MESSAGES_COUNT,u=parseInt,!n[t]&&e[s.toLowerCase()]&&(n[t]=u?u(e[s.toLowerCase()]):e[s.toLowerCase()])},t.exports=u},{"./../../../common/common.core":6}],57:[function(e,t,s){var r=e("./../../../common/common.core"),u=r.util,n=r.xmlbuilder,o=r.Constants,i=o.HeaderConstants;function a(e,t,s){e&&(this.queue=e),t&&(this.messageId=t),s&&(this.popReceipt=s)}a.serialize=function(e,t){var s,r=n.create();(r=r.begin(o.QueueConstants.QUEUE_MESSAGE_ELEMENT,{version:"1.0",encoding:"utf-8"}),e)?(s=null!==t&&void 0!==t?t.encode(e):e,r.ele(o.QueueConstants.MESSAGE_TEXT_ELEMENT).txt(s).up()):r.ele(o.QueueConstants.MESSAGE_TEXT_ELEMENT).up();return r.doc().toString()},a.parse=function(e,t){var s=new a;for(var r in e){if(r===o.QueueConstants.MESSAGE_TEXT_ELEMENT)s.messageText=null!==t&&void 0!==t?t.decode(e[r]):e[r];else s[u.normalizePropertyNameFromXML(r)]=e[r]}return s.dequeueCount&&(s.dequeueCount=parseInt(s.dequeueCount)),s},a.prototype.getPropertiesFromHeaders=function(e){var t=this,s=function(s,r){!t[s]&&e[r.toLowerCase()]&&(t[s]=e[r.toLowerCase()])};s("popReceipt",i.POP_RECEIPT),s("timeNextVisible",i.TIME_NEXT_VISIBLE)},t.exports=a},{"./../../../common/common.core":6}],59:[function(e,t,s){(function(s){var r=e("util");function u(){}function n(){}function o(){}function i(){}u.prototype.encode=function(e){return e},u.prototype.decode=function(e){return e},r.inherits(n,u),n.prototype.encode=function(e){return new s(e,"utf8").toString("base64")},n.prototype.decode=function(e){return new s(e,"base64").toString("utf8")},r.inherits(o,u),o.prototype.encode=function(e){return e.toString("base64")},o.prototype.decode=function(e){return new s(e,"base64")},r.inherits(i,u),i.prototype.encode=function(e){return e.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;").replace(/'/gm,"&apos;")},i.prototype.decode=function(e){return e.replace(/&amp;/gm,"&").replace(/&lt;/gm,"<").replace(/&gt;/gm,">").replace(/&quot;/gm,'"').replace(/&apos;/gm,"'")},t.exports=u,t.exports.TextBase64QueueMessageEncoder=n,t.exports.BinaryBase64QueueMessageEncoder=o,t.exports.TextXmlQueueMessageEncoder=i}).call(this,e("buffer").Buffer)},{buffer:"buffer",util:"util"}]},{},[3]);
